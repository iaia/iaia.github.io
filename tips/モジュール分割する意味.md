モジュール分割する意味

## ビルド時間

- 例えば100行のアプリがある
- 例えば1行コンパイルするのに1秒かかる
- 1行変更加えただけでアプリをビルドするのに100秒かかる
    - ※ 実際にはクラス単位とかでコンパイル済みなので、そのクラスに依存している部分だけがビルド対象になってそんなにはかからないはず
- このアプリが10行ずつのモジュールに分かれていると
    - 例えば ABCDEFGHIJ のモジュール
    - 依存関係は A->B->C->D->E->F->G->H->I->J
    -
- すでにビルド済みのモジュールがあればそのモジュールはビルドをしなくて良い
    - インクリメンタルビルド(増分ビルド)という仕組み
    - 例えばBに変更を加えた場合
        - CDEFGHIJはビルドしなくていい
        - Bをビルド -> Aをビルドの手順
        - 10秒 -> 10秒なので20秒のビルドになる
    - Bを細分化し、XとYに5行ずつ分割した場合
        - Xにのみ変更を加えた場合は?
            - X -> Aのビルドで15秒
    - BがCに依存していて、Cに変更を加えた場合は?
        - C->B->A のビルドで30秒
        - もしBがCに依存していなければ?
            - C->Aのビルドで20秒
- モジュールを細分化し、依存関係を少なくするとビルド時間は高速になる

### 現実で考えると
- Aがでかくて55行ある
- BCD…IJは5行ずつ
- Bに変更を加えると?
    - B->Aで60秒かかる
- Aを細分化してあげることが大切

## とりあえず何をすると良いのか
- Aはあまりにも大きいので、これを適切なモジュールに持っていこうとするととんでもない時間がかかる
    - 適切なモジュールがそもそもある?
    - 適切なモジュール作るところから?
    - このコードはどこに置くのが適切なんだろう?
    - AのXXXはYYYに依存していて、YYYはZZZに依存しているから、まずAの中で依存関係をキレイにしないと移動させられない
- Aにどうしても必要なコードだけ残して、それ以外はすべてlegacyモジュールに移動する
    - これにより例えばlegacyに50行、Aに5行となればBに変更を加えたときに
        - B->A で10秒になるかも
    - あんまりlegacyに全部持っていきすぎるとB->legacy->Aになってしまうので変わらない可能性もある
    - Aが他のモジュールを集約するような状態にし、他のモジュールはそれ以外のモジュールに依存しすぎない関係が理想
- ただし、以下の問題がある
    - Aにどうしても必要なコードが何かが分からない
    - Aで新規にコードを書く必要もある
    - それ以外のすべてのコードを移動すると他のエンジニアの作業とコンフリクトする
- つまり実際には以下のような手順が必要そう
    - 他のエンジニアが作業していないコードで、Aの中で他のコードにに依存していないコードを少しずつlegacyに移動させる
    - 他のエンジニアが作業していないコードで、ほんの少しだけ依存している程度のコードを少しずつlegacyに移動させる
    - 残りを移動させる&Aで必要なコードを書く
- 
