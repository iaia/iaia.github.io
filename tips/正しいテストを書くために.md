正しいテストを書くために

- SUTを分析する
- めちゃくちゃ単純に抽象化する
    - データがあって、それを計算して、DBに格納する
    - もっというとインプットがあってアウトプットがある
- つまりテストで書かなければならないことも単純
    - テストデータを用意して、DBに入ってるものが正しいこと
    - インプットを用意して、アウトプットを検査する
- どういう時にテストが落ちて欲しいか? を考える
    - インプットが変わる、アウトプットが変わる
    - 定数が変わる
    - SUTの計算方法が変わる
- 反対に結構な変更を加えたのにテストが落ちない
    - 何か良くないmock、stubの仕方をしている可能性がある
- 計算方法はテストしてはならない
    - もしエッジケースの計算方法があるならば、それがインプットアウトプットのデータで表現できるはず
    - 例えば四角形の面積は、計算結果はどうでも良くて、結果が正しければそれで良い
        - (上底+下底)*高さ/2 で計算しているかどうかはどうでもいい
- 複雑なケース
    - データがあって、それを外部に問い合わせをして、その結果をDBに格納する
    - 外部への問い合わせ方法もアウトプットとして捉える
    - つまりインプット=>アウトプットではなく、インプット=>アウトプット=>インプット=>アウトプットになる
    - やることは変わらない

